##heatmap code demo, taken from Prum et al (2015)
#if using please cite
#Prum RO, Berv JS, Dornburg A, Field DJ, Townsend JP, Lemmon EM, Lemmon AR. A comprehensive phylogeny of birds (Aves) using targeted next-generation DNA sequencing. Nature. 2015 Oct;526(7574):569.

library(PhyInformR)

##read in the rates from the other file
p002<-ratesA[1:215]
p003<-ratesA[216:469]
p005<-ratesA[470:1190]
p006<-ratesA[1191:1341]
p007<-ratesA[1342:1568]
p009<-ratesA[1569:1768]
p0010<-ratesA[1769:1911]
p0011<-ratesA[1912:2021]
p0013<-ratesA[2022:2146]
p0014<-ratesA[2147:2319]
p0015<-ratesA[2320:2450]
p0016<-ratesA[2451:2620]
p0017<-ratesA[2621:2824]
p0018<-ratesA[2825:3003]
p0020<-ratesA[3004:3166]
p0021<-ratesA[3167:3369]
p0022<-ratesA[3370:3577]
p0023<-ratesA[3578:3811]
p0024<-ratesA[3812:4008]
p0025<-ratesA[4009:4163]
p0026<-ratesA[4164:4402]
p0027<-ratesA[4403:4569]
p0028<-ratesA[4570:4797]
p0029<-ratesA[4798:4976]
p0030<-ratesA[4977:5146]
p0031<-ratesA[5147:5298]
p0032<-ratesA[5299:5455]
p0033<-ratesA[5456:5634]
p0035<-ratesA[5635:5852]
p0036<-ratesA[5853:6010]
p0037<-ratesA[6011:6170]
p0038<-ratesA[6171:6291]
p0039<-ratesA[6292:6411]
p0040<-ratesA[6412:6520]
p0041<-ratesA[6521:6756]
p0042<-ratesA[6757:6994]
p0043<-ratesA[6995:7485]
p0044<-ratesA[7486:7637]
p0046<-ratesA[7638:7756]
p0048<-ratesA[7757:7968]
p0050<-ratesA[7969:8177]
p0051<-ratesA[8178:8359]
p0052<-ratesA[8360:8508]
p0053<-ratesA[8509:8681]
p0055<-ratesA[8682:9024]
p0056<-ratesA[9025:9239]
p0057<-ratesA[9240:9389]
p0058<-ratesA[9390:9532]
p0059<-ratesA[9533:9839]
p0060<-ratesA[9840:10012]
p0061<-ratesA[10013:10230]
p0062<-ratesA[10231:10409]
p0063<-ratesA[10410:10563]
p0064<-ratesA[10564:10721]
p0066<-ratesA[10722:10894]
p0067<-ratesA[10895:11115]
p0068<-ratesA[11116:11293]
p0069<-ratesA[11294:11458]
p0070<-ratesA[11459:11649]
p0071<-ratesA[11650:11831]
p0072<-ratesA[11832:11981]
p0074<-ratesA[11982:12152]
p0075<-ratesA[12153:12343]
p0076<-ratesA[12344:12489]
p0078<-ratesA[12490:12629]
p0079<-ratesA[12630:12780]
p0080<-ratesA[12781:12974]
p0081<-ratesA[12975:13165]
p0082<-ratesA[13166:13337]
p0083<-ratesA[13338:13501]
p0084<-ratesA[13502:13643]
p0085<-ratesA[13644:13826]
p0086<-ratesA[13827:14205]
p0088<-ratesA[14206:14417]
p0089<-ratesA[14418:14578]
p0090<-ratesA[14579:14758]
p0092<-ratesA[14759:14991]
p0093<-ratesA[14992:15125]
p0094<-ratesA[15126:15400]
p0095<-ratesA[15401:15564]
p0096<-ratesA[15565:15810]
p0097<-ratesA[15811:15973]
p0098<-ratesA[15974:16186]
p0099<-ratesA[16187:16329]
p00100<-ratesA[16330:16447]
p00101<-ratesA[16448:16578]
p00102<-ratesA[16579:16757]
p00103<-ratesA[16758:16982]
p00104<-ratesA[16983:17137]
p00105<-ratesA[17138:17439]
p00106<-ratesA[17440:17596]
p00107<-ratesA[17597:17762]
p00108<-ratesA[17763:18010]
p00109<-ratesA[18011:18139]
p00110<-ratesA[18140:18346]
p00111<-ratesA[18347:18511]
p00112<-ratesA[18512:18663]
p00113<-ratesA[18664:18843]
p00114<-ratesA[18844:19009]
p00115<-ratesA[19010:19214]
p00118<-ratesA[19215:19428]
p00119<-ratesA[19429:19643]
p00120<-ratesA[19644:19755]
p00121<-ratesA[19756:19857]
p00122<-ratesA[19858:20068]
p00123<-ratesA[20069:20256]
p00124<-ratesA[20257:20555]
p00126<-ratesA[20556:20722]
p00127<-ratesA[20723:20886]
p00128<-ratesA[20887:21027]
p00129<-ratesA[21028:21196]
p00130<-ratesA[21197:21369]
p00131<-ratesA[21370:21560]
p00132<-ratesA[21561:21811]
p00133<-ratesA[21812:22126]
p00135<-ratesA[22127:22293]
p00136<-ratesA[22294:22407]
p00137<-ratesA[22408:22559]
p00138<-ratesA[22560:22765]
p00141<-ratesA[22766:22950]
p00142<-ratesA[22951:23150]
p00143<-ratesA[23151:23369]
p00146<-ratesA[23370:23490]
p00147<-ratesA[23491:23618]
p00149<-ratesA[23619:23781]
p00150<-ratesA[23782:23939]
p00152<-ratesA[23940:24063]
p00156<-ratesA[24064:24239]
p00157<-ratesA[24240:24409]
p00159<-ratesA[24410:24550]
p00164<-ratesA[24551:24702]
p00165<-ratesA[24703:24859]
p00166<-ratesA[24860:25027]
p00167<-ratesA[25028:25167]
p00169<-ratesA[25168:25329]
p00170<-ratesA[25330:25461]
p00171<-ratesA[25462:25576]
p00172<-ratesA[25577:25735]
p00173<-ratesA[25736:25835]
p00174<-ratesA[25836:25950]
p00175<-ratesA[25951:26108]
p00176<-ratesA[26109:26286]
p00177<-ratesA[26287:26558]
p00178<-ratesA[26559:26771]
p00179<-ratesA[26772:26944]
p00180<-ratesA[26945:27162]
p00181<-ratesA[27163:27321]
p00182<-ratesA[27322:27512]
p00183<-ratesA[27513:27634]
p00184<-ratesA[27635:27797]
p00185<-ratesA[27798:27925]
p00189<-ratesA[27926:28026]
p00190<-ratesA[28027:28184]
p00191<-ratesA[28185:28382]
p00192<-ratesA[28383:28684]
p00193<-ratesA[28685:28842]
p00194<-ratesA[28843:28970]
p00196<-ratesA[28971:29140]
p00198<-ratesA[29141:29338]
p00199<-ratesA[29339:29526]
p00200<-ratesA[29527:29747]
p00202<-ratesA[29748:29952]
p00204<-ratesA[29953:30141]
p00207<-ratesA[30142:30305]
p00208<-ratesA[30306:30415]
p00209<-ratesA[30416:30890]
p00211<-ratesA[30891:31099]
p00212<-ratesA[31100:31281]
p00213<-ratesA[31282:31483]
p00214<-ratesA[31484:31650]
p00215<-ratesA[31651:32144]
p00216<-ratesA[32145:32518]
p00218<-ratesA[32519:32694]
p00219<-ratesA[32695:32851]
p00220<-ratesA[32852:33024]
p00221<-ratesA[33025:33133]
p00222<-ratesA[33134:33327]
p00223<-ratesA[33328:33482]
p00224<-ratesA[33483:33657]
p00225<-ratesA[33658:33803]
p00226<-ratesA[33804:33994]
p00227<-ratesA[33995:34140]
p00228<-ratesA[34141:34283]
p00229<-ratesA[34284:34435]
p00231<-ratesA[34436:34547]
p00232<-ratesA[34548:34696]
p00233<-ratesA[34697:34854]
p00234<-ratesA[34855:34997]
p00235<-ratesA[34998:35164]
p00236<-ratesA[35165:35337]
p00237<-ratesA[35338:35491]
p00238<-ratesA[35492:35691]
p00239<-ratesA[35692:35957]
p00241<-ratesA[35958:36122]
p00242<-ratesA[36123:36315]
p00243<-ratesA[36316:36473]
p00244<-ratesA[36474:36653]
p00245<-ratesA[36654:36856]
p00247<-ratesA[36857:37047]
p00248<-ratesA[37048:37154]
p00249<-ratesA[37155:37321]
p00250<-ratesA[37322:37497]
p00251<-ratesA[37498:37615]
p00253<-ratesA[37616:37773]
p00254<-ratesA[37774:37928]
p00255<-ratesA[37929:38074]
p00256<-ratesA[38075:38268]
p00257<-ratesA[38269:38432]
p00258<-ratesA[38433:38591]
p00259<-ratesA[38592:38820]
p00260<-ratesA[38821:39017]
p00261<-ratesA[39018:39229]
p00262<-ratesA[39230:39430]
p00263<-ratesA[39431:39609]
p00264<-ratesA[39610:39824]
p00265<-ratesA[39825:40308]
p00266<-ratesA[40309:40451]
p00267<-ratesA[40452:40817]
p00268<-ratesA[40818:41095]
p00269<-ratesA[41096:41250]
p00271<-ratesA[41251:41388]
p00272<-ratesA[41389:41621]
p00273<-ratesA[41622:41842]
p00274<-ratesA[41843:41994]
p00275<-ratesA[41995:42136]
p00276<-ratesA[42137:42430]
p00277<-ratesA[42431:42589]
p00278<-ratesA[42590:42770]
p00279<-ratesA[42771:42919]
p00280<-ratesA[42920:43101]
p00281<-ratesA[43102:43374]
p00282<-ratesA[43375:43529]
p00283<-ratesA[43530:43726]
p00285<-ratesA[43727:43888]
p00286<-ratesA[43889:44136]
p00287<-ratesA[44137:44272]
p00288<-ratesA[44273:44443]
p00289<-ratesA[44444:44628]
p00293<-ratesA[44629:44787]
p00294<-ratesA[44788:44913]
p00295<-ratesA[44914:45101]
p00296<-ratesA[45102:45274]
p00298<-ratesA[45275:45425]
p00299<-ratesA[45426:45544]
p00300<-ratesA[45545:45703]
p00302<-ratesA[45704:45816]
p00303<-ratesA[45817:46084]
p00304<-ratesA[46085:46257]
p00305<-ratesA[46258:46448]
p00306<-ratesA[46449:46693]
p00307<-ratesA[46694:46975]
p00308<-ratesA[46976:47127]
p00309<-ratesA[47128:47276]
p00310<-ratesA[47277:47477]
p00315<-ratesA[47478:47613]
p00316<-ratesA[47614:48064]
p00317<-ratesA[48065:48255]
p00318<-ratesA[48256:48401]
p00319<-ratesA[48402:48583]
p00320<-ratesA[48584:48748]
p00321<-ratesA[48749:48943]
p00323<-ratesA[48944:49052]
p00324<-ratesA[49053:49216]
p00325<-ratesA[49217:49391]
p00326<-ratesA[49392:49549]
p00327<-ratesA[49550:49695]
p00329<-ratesA[49696:49862]
p00330<-ratesA[49863:50121]
p00331<-ratesA[50122:50303]
p00332<-ratesA[50304:50503]
p00333<-ratesA[50504:50758]
p00334<-ratesA[50759:50867]
p00335<-ratesA[50868:51008]
p00336<-ratesA[51009:51174]
p00337<-ratesA[51175:51277]
p00339<-ratesA[51278:51429]
p00340<-ratesA[51430:51592]
p00343<-ratesA[51593:51790]
p00344<-ratesA[51791:51960]
p00346<-ratesA[51961:52078]
p00347<-ratesA[52079:52237]
p00348<-ratesA[52238:52383]
p00353<-ratesA[52384:52594]
p00354<-ratesA[52595:52730]
p00355<-ratesA[52731:52891]
p00356<-ratesA[52892:53046]
p00357<-ratesA[53047:53178]
p00358<-ratesA[53179:53359]
p00359<-ratesA[53360:53462]
p00360<-ratesA[53463:53602]
p00362<-ratesA[53603:53772]
p00363<-ratesA[53773:53883]
p00364<-ratesA[53884:53993]
p00365<-ratesA[53994:54221]
p00366<-ratesA[54222:54439]
p00367<-ratesA[54440:54580]
p00369<-ratesA[54581:54768]
p00370<-ratesA[54769:55058]
p00372<-ratesA[55059:55210]
p00373<-ratesA[55211:55355]
p00374<-ratesA[55356:55579]
p00375<-ratesA[55580:55780]
p00377<-ratesA[55781:55929]
p00378<-ratesA[55930:56084]

#get lengths and sort, pick 19!
length(p005)->lep005
length(p0013)->lep0013
length(p0020)->lep0020
length(p0053)->lep0053
length(p0059)->lep0059
length(p00105)->lep00105
length(p00111)->lep00111
length(p00119)->lep00119
length(p00150)->lep00150
length(p00211)->lep00211
length(p00212)->lep00212
length(p00321)->lep00321
length(p00329)->lep00329
length(p00344)->lep00344
length(p00346)->lep00346
length(p00353)->lep00353
length(p00359)->lep00359
length(p00375)->lep00375
length(p00377)->lep00377
c(lep005,lep0013,lep0020,lep0053,lep0059,lep00105,lep00111,lep00119,lep00150,lep00211,lep00212,lep00321,lep00329,lep00344,lep00346,lep00353,lep00359,lep00375,lep00377)->ll
names(ll)<-c("lep005","lep0013","lep0020","lep0053","lep0059","lep00105","lep00111","lep0119","lep00150","lep00211","lep00212","lep00321","lep329","lep344","lep346","lep353","lep359","lep375","lep377")
sort(ll)


#you may need to convert each of the pieces to a matrix
as.matrix(ratesA)->ratesA

as.matrix(p005)-> p005
as.matrix(p0013)-> p0013
as.matrix(p0020)-> p0020
as.matrix(p005)-> p0053
as.matrix(p005)-> p0059
as.matrix(p0013)-> p00105
as.matrix(p0020)-> p00111
as.matrix(p005)-> p00119
as.matrix(p0013)-> p00150
as.matrix(p005)-> p00211
as.matrix(p0013)-> p00212
as.matrix(p0020)-> p00321
as.matrix(p005)-> p00329
as.matrix(p0020)-> p00344
as.matrix(p005)-> p00346
as.matrix(p0013)-> p00353
as.matrix(p0020)-> p00359
as.matrix(p005)-> p00375
as.matrix(p005)-> p00377


space.maker(ratesA,.90,3)->a1 
space.maker(p005,.90,3)->a2 
space.maker(p0013,.90,3)->a3 
space.maker(p0020,.90,3)->a4 
space.maker(p0053,.90,3)->a5 
space.maker(p0059,.90,3)->a6 
space.maker(p00105,.90,3)->a7 
space.maker(p00111,.90,3)->a8 
space.maker(p00119,.90,3)->a9 
space.maker(p00150,.90,3)->a10 
space.maker(p00211,.90,3)->a11 
space.maker(p00212,.90,3)->a12 
space.maker(p00321,.90,3)->a13 
space.maker(p00329,.90,3)->a14 
space.maker(p00344,.90,3)->a15 
space.maker(p00346,.90,3)->a16 
space.maker(p00353,.90,3)->a17 
space.maker(p00359,.90,3)->a18 
space.maker(p00375,.90,3)->a19 
space.maker(p00377,.90,3)->a20

rbind(a18,a16,a3,a20,a10,a4,a8,a14,a15,a5,a12,a13,a19,a11,a17,a9,a7,a6,a2,a1)->demo 
as.matrix(demo)->demo2
row.names(demo2)<- 
c("lep359","lep346","lep0013","lep377", "lep00150" ,"lep0020" ,"lep00111","lep329", "lep344","lep0053","lep00212", "lep00321","lep375","lep00211","lep353", "lep0119","lep00105","lep0059","lep005","allrates")
 .30/20->by.this
seq(by.this,0.30-0.0001,by=by.this)->lilts 
colnames(demo2)<-lilts
heatmap.2(demo2, Colv=F,Rowv=F, scale='none')
